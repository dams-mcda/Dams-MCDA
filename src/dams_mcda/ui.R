# This is the user-interface definition of a Shiny web application. You can
# run the application by clicking 'Run App' above.
#
#base_dir <- "~/Beatrice2/R_ELF/R_NEST/MCDA_App_Shiny/"
#working_dir <- paste("MCDA_11132018/WSM_Tool", "", sep="")
#setwd(working_dir)

base_dir <- "/srv/shiny-server/dams_mcda/"
setwd(base_dir)

library(shiny)
library(ggplot2)
library(dplyr)
library(shinyjs)
library(Cairo)
library(RColorBrewer)
library(spatstat)
library(rgdal)

options(shiny.usecairo=T)

source("server.R")

# default graph dimensions
graph_width <- "100%"
graph_height <- 500

# multiple used labels
fishSurvivalLabel <- "Fish survival is measured in thousands of lbs or metric tonnes. It is estimated as possible upstream sea-run fish (Atlantic salmon, Alewife, Blueback herring, American eel) biomass calculated using functional habitat units (Roy et al., 2018). "
riverRecLabel <- "River recreation is measured in square miles or kilometers. It is the estimated downstream area of river that may increase or decrease with a dam decision alternative, combines functional area for whitewater and flatwater recreation defined by Roy et al. (2018)."
resStorageLabel <- "Reservoir storage is measured in cubic miles or kilometers. It is the estimated storage potential of the reservoir, based on its volume (Roy et al., 2018)."
annuitizedProjCostsLabel <- "Annuitized project cost is measured in 2018 $USD. It is the estimated total project costs (capital and operation & maintenance) on an annual basis using a 6.2% discount rate and a 20-year lifetime."
numPropertiesLabel <- "Number of properties is the estimated number of properties impacted near the dam, based on potential changes in viewshed or property value (Roy et al., 2018). "
breachDamageLabel <- "Breach damange potential is a unitless proxy for safety based on the State hazard rating, which indicates the potential for downstream property damage, injury, and death in the case of dam breach (Roy et al., 2018)."
annualElectricityLabel <- "Annual electricity generation is measured in MWh/year. average estimate based on nameplate capacity from FERC licenses for each hydropower project."
GHGEmissionsLabel <- "Annual carbon dioxide (CO2) emissions reduction is measured in lbs or metric tonnes of CO2/year. It is an estimate of avoided carbon dioxide emissions from annual hydropower-generated electricity production; based on decreasing generation from the State's electricity generation mix; does not include life cycle emissions impacts."
indigenousLifewaysLabel <- "Indigenous cultural traditions and lifeways is a unitless measure used as a proxy for the importance of preserving or restoring the cultural traditions and lifeways of indigenous people."
communityIdentityLabel <- "Community identity is a unitless measure used to convey the importance of preserving the existing identity of the community residents."
industrialHistoryLabel <- "Industrial historical importance is a unitless measure to convey the imprtance of preserving or restoring the industrial historical value of the infrastructure."
aestheticsLabel <- "Aesthetic value is a unitless measure to convey the importance of improving or preserving the aesthetics (e.g, appearance, scenic value, smell, sound) at the dam."
healthLabel <- "Public health is a unitless measure to convey the importance of human public health connected with a flowing river free from pollutants."
justiceLabel <- "Socio-environmental justice is a unitless measure to convey the importance of socio-environmental justice issues (e.g. tribal sovereignty) related to the dam."



# Define UI for Shiny web application
ui <- shinyUI(fluidPage(
	# used for toggling display of elements
	shinyjs::useShinyjs(),

	# link css
	tags$head(
		tags$link(rel = "stylesheet", type = "text/css", href = "dams_mcda.css")
	),

	titlePanel("Dam Decision Support Tool"),

	navlistPanel(
	  "Step 1",
		# Define layout widths
		widths = c(2,10),

		#Define Instructions tab
		tabPanel("Start Here",
			htmlOutput("Step 1: Start Here"),
			h2("Step 1: Start Here"),
			HTML(
				 "<b>Welcome to the Dam Decision Support Tool! </b>Please login with a username (email address) and a password.<br> \

				 <br>Are you entering <b>(a) individual</b> or <b>(b) group</b> preference information? (select one).<br> \

				 <br>This <b>free and open source</b> tool was developed to aid people like you in considering tradeoffs associated with dams. It can help support getting involved in decision making about hydropower dams licensed through the\
         Federal Energy Regulatory Commission (FERC), but could easily be tailored toward other types of dam decisions. The tool generates a data-driven recommendation for hydropower dams in Maine's Penobscot River, based on user preferences, \
         to support your interaction in the FERC Integrated Licensing Process.<br> \

				 This tool is based on the Weighted Sum approach to Multi-Criteria Decision Analysis (MCDA) to compare decision-maker preferences for decision criteria (e.g., annuitized cost, greenhouse gas emissions reductions, sea-run fish \
         survival, etc.) for hydropower dams with upcoming FERC license expiration dates. The tool gathers user inputs and calculates a ranked set of decision alternatives (e.g. keep and maintain dam, improve hydropower generation, improve\ 
         fish passage) for each dam. Then, tool optimizes across the set of dams coming up for relicensing to suggest a coordinated dam decision.<br> \

				 <h2>Instructions for Uploading Group Preferences</h2>\

				 Use this option only if you have done this activity before and have used the blank decision matrix HERE to organize your data. Press the UPLOAD button, and select the appropriate .xlsx or .csv file to upload the preference values\
         for you or the average preference values for your group. <br>\
      "
			 )
		),
		
    "Step 2: View Dam Map", 
		tabPanel(
		  htmlOutput("Map1"), # status and title
		  h2("Existing FERC Dams Map"),
		  HTML("Please consider the following dams on the Penobscot River. These non-federally owned dams are coming up for FERC relicensing within the next 10 years. These are the dams you will focus on \
		       <br>for the rest of the activity. Note: although the Penobscot Mills Project dams are licensed together under a single FERC license, we separate them here for consistency. \ 
		       <br>Hover over the dams on the map for more information on each site.<br>\
		       <br><b>Click HERE for additional resources.</b><br>"
		    )
		  ),
		
		"Step 3: Enter Preferences",
		tabPanel(
			htmlOutput("Dam1"), # status and title
			h2("West Enfield Dam (FERC No. P-"),
			HTML("Please consider the decision criteria listed below for West Enfield Dam. \
         <a>https://github.com/dams-mcda/Dams-MCDA/blob/TabsUpdate_Dams/src/dams_mcda/Factsheet_WestEnfield.pdf</a>
         <br><b>Warning: decision criteria ratings must sum to 1!</b> The tracking indicator (in the box to the right of the first decision criterion) will help you keep track of the sum. Be aware that decision criteria are directly compensating (i.e., if the sum of all ratings is 1, then\ 
         increasing the rating on one criterion requires another criterion rating to decrease to keep the sum equal to 1). <br>\
				 <br> Please consider and rate the given set of decision criteria based on the case of removing the dam. <b>In each case, 0 = not at all important and 1 = extremely important.</b><br>"
			),

			htmlOutput("Dam1Progress"),

			#----------------------------------------
			# Criteria Inputs for West Enfield Dam
			#----------------------------------------
			#Fish Survival
			div(id="fish-survival-1",
				h3("Fish Survival"),
				sliderInput(inputId = "FishBiomass1", label = fishSurvivalLabel, value=0, min=0, max=1, step = 0.025)
			),
			#River Recreation
			div(id="river-rec-1",
				h3("River Recreation"),
				sliderInput(inputId = "RiverRec1", label = riverRecLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Reservoir Storage
			div(id="res-storage-1",
				h3("Reservoir Storage"),
				sliderInput(inputId = "Reservoir1", label = resStorageLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Annuitized Project Costs
			div(id="ann-proj-costs-1",
				h3("Annuitized Project Costs"),
				sliderInput(inputId = "ProjectCost1", label = annuitizedProjCostsLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Breach Damage Potential
			div(id="breach-damage-1",
				h3("Breach Damage Potential"),
				sliderInput(inputId = "Safety1", label = breachDamageLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Number of Properties
			div(id="num-prop-1",
				h3("Number of Properties"),
				sliderInput(inputId = "NumProperties1", label = numPropertiesLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Annual Electricity Generation
			div(id="ann-elec-gen-1",
				h3("Annual Electricity Generation"),
				sliderInput(inputId = "ElectricityGeneration1", label = annualElectricityLabel, value=0, min=0, max=1, step = 0.025)
			),
			#GHGEmissions
			div(id="ghg-emissions-1",
				h3("CO2 Emissions Reductions"),
				sliderInput(inputId = "AvoidEmissions1", label = GHGEmissionsLabel, value=0, min=0, max=1, step = 0.025)
			),
			#IndigenousLifeways
			div(id="indig-lifeways-1",
				h3("Indigenous Cultural Traditions and Lifeways"),
				sliderInput(inputId = "IndigenousLifeways1", label = indigenousLifewaysLabel, value=0, min=0, max=1, step = 0.025)
			),
			#IndustrialHistory
			div(id="industrial-1",
				h3("Industrial Historical Importance"),
				sliderInput(inputId = "IndustrialHistory1", label = industrialHistoryLabel, value=0, min=0, max=1, step = 0.025)
			),
			#CommunityIdentity
			div(id="community-1",
				h3("Community Identity"),
				sliderInput(inputId = "CommunityIdentity1", label = communityIdentityLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Aesthetics
			div(id="aesthetics-1",
				h3("Aesthetic Value"),
				sliderInput(inputId = "Aesthetics1", label = aestheticsLabel, value=0, min=0, max=1, step = 0.025)
			),
			#PublicHealth
			div(id="health-1",
			    h3("Public Health"),
			    sliderInput(inputId = "Health1", label = healthLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Justice
			div(id="justice-1",
			    h3("Socio-Environmental Justice"),
			    sliderInput(inputId = "Justice1", label = justiceLabel, value=0, min=0, max=1, step = 0.025)
			),
			
			# update alt 1 score
			actionButton("updateBtn1", "Update")
			
		), # end
		#End West Enfield Dam Tab

		tabPanel(
			#"Medway Dam",
			htmlOutput("Dam2"), # status and title
			h2("Medway Dam"),
      
			HTML(
				"Please consider the decision criteria listed below for Medway Dam. <a>https://github.com/dams-mcda/Dams-MCDA/blob/TabsUpdate_Dams/src/dams_mcda/Factsheet_Medway.pdf</a>\
        <br><b>Warning: decision criteria ratings must sum to 1!</b> The tracking indicator (in the box to the right of the first decision criterion) will help you keep track of the sum. Be aware that decision criteria are directly compensating (i.e., if the sum of all ratings is 1, then\ 
        increasing the rating on one criterion requires another criterion rating to decrease to keep the sum equal to 1). <br>\
				<br>Please consider and rate the given set of criteria based on the case of improvements to fish passage at the dam.<b> In each case, 0 = not at all important and 1 = extremely important.</b><br>"
			),

			htmlOutput("Dam2Progress"),

			#----------------------------------------
			# Criteria Inputs for Alt 2
			#----------------------------------------
			#Fish Survival
			div(id="fish-survival-2",
				h3("Fish Survival"),
				sliderInput(inputId = "FishBiomass2", label = fishSurvivalLabel, value=0, min=0, max=1, step = 0.025)
			),
			#River Recreation
			div(id="river-rec-2",
				h3("River Recreation"),
				sliderInput(inputId = "RiverRec2", label = riverRecLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Reservoir Storage
			div(id="res-storage-2",
				h3("Reservoir Storage"),
				sliderInput(inputId = "Reservoir2", label = resStorageLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Annuitized Project Costs
			div(id="ann-proj-costs-2",
				h3("Annuitized Project Costs"),
				sliderInput(inputId = "ProjectCost2", label = annuitizedProjCostsLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Breach Damage Potential
			div(id="breach-damage-2",
				h3("Breach Damage Potential"),
				sliderInput(inputId = "Safety2", label = breachDamageLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Number of Properties
			div(id="num-prop-2",
				h3("Number of Properties"),
				sliderInput(inputId = "NumProperties2", label = numPropertiesLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Annual Electricity Generation
			div(id="ann-elec-gen-2",
				h3("Annual Electricity Generation"),
				sliderInput(inputId = "ElectricityGeneration2", label = annualElectricityLabel, value=0, min=0, max=1, step = 0.025)
			),
			#GHGEmissions
			div(id="ghg-emissions-2",
				h3("CO2 Emissions Reductions"),
				sliderInput(inputId = "AvoidEmissions2", label = GHGEmissionsLabel, value=0, min=0, max=1, step = 0.025)
			),
			#IndigenousLifeways
			div(id="indig-lifeways-2",
				h3("Indigenous Cultural Traditions and Lifeways"),
				sliderInput(inputId = "IndigenousLifeways2", label = indigenousLifewaysLabel, value=0, min=0, max=1, step = 0.025)
			),
			#IndustrialHistory
			div(id="industrial-2",
				h3("Industrial Historical Importance"),
				sliderInput(inputId = "IndustrialHistory2", label = industrialHistoryLabel, value=0, min=0, max=1, step = 0.025)
			),
			#CommunityIdentity
			div(id="community-2",
				h3("Community Identity"),
				sliderInput(inputId = "CommunityIdentity2", label = communityIdentityLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Aesthetics
			div(id="aesthetics-2",
				h3("Aesthetic Value"),
				sliderInput(inputId = "Aesthetics2", label = aestheticsLabel, value=0, min=0, max=1, step = 0.025)
			),
			#PublicHealth
			div(id="health-2",
			    h3("Public Health"),
			    sliderInput(inputId = "Health2", label = healthLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Justice
			div(id="justice-2",
			    h3("Socio-Environmental Justice"),
			    sliderInput(inputId = "Justice2", label = justiceLabel, value=0, min=0, max=1, step = 0.025)
			),
			
			actionButton("updateBtn2", "Update")

		), # end
		#End Medway Dam Tab


		tabPanel(
			#"Millinocket Dam",
			htmlOutput("Dam3"), # status and title
			h2("Millinocket Dam"),
			HTML(
				"Please consider the decision criteria listed below for Millinocket Dam. <a>https://github.com/dams-mcda/Dams-MCDA/blob/TabsUpdate_Dams/src/dams_mcda/Factsheet_PenobscotMills.pdf</a>\
        <br><b>Warning: decision criteria ratings must sum to 1!</b> The tracking indicator (in the box to the right of the first decision criterion) will help you keep track of the sum. Be aware that decision criteria are directly compensating (i.e., if the sum of all ratings is 1, then\ 
        increasing the rating on one criterion requires another criterion rating to decrease to keep the sum equal to 1). <br>\
				<br> Please consider and rate the given set of criteria based on the case of improved hydropower generation at the dam. <b>In each case, 0 = not at all important and 1 = extremely important.</b><br>"
			),

			htmlOutput("Dam3Progress"),

			#----------------------------------------
			# Criteria Inputs for Millinocket Dam
			#----------------------------------------
			#Fish Survival
			div(id="fish-survival-3",
				h3("Fish Survival"),
				sliderInput(inputId = "FishBiomass3", label = fishSurvivalLabel, value=0, min=0, max=1, step = 0.025)
			),
			#River Recreation
			div(id="river-rec-3",
				h3("River Recreation"),
				sliderInput(inputId = "RiverRec3", label = riverRecLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Reservoir Storage
			div(id="res-storage-3",
				h3("Reservoir Storage"),
				sliderInput(inputId = "Reservoir3", label = resStorageLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Annuitized Project Costs
			div(id="ann-proj-costs-3",
				h3("Annuitized Project Costs"),
				sliderInput(inputId = "ProjectCost3", label = annuitizedProjCostsLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Breach Damage Potential
			div(id="breach-damage-3",
				h3("Breach Damage Potential"),
				sliderInput(inputId = "Safety3", label = breachDamageLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Number of Properties
			div(id="num-prop-3",
				h3("Number of Properties"),
				sliderInput(inputId = "NumProperties3", label = numPropertiesLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Annual Electricity Generation
			div(id="ann-elec-gen-3",
				h3("Annual Electricity Generation"),
				sliderInput(inputId = "ElectricityGeneration3", label = annualElectricityLabel, value=0, min=0, max=1, step = 0.025)
			),
			#GHGEmissions
			div(id="ghg-emissions-3",
				h3("CO2 Emissions Reductions"),
				sliderInput(inputId = "AvoidEmissions3", label = GHGEmissionsLabel, value=0, min=0, max=1, step = 0.025)
			),
			#IndigenousLifeways
			div(id="indig-lifeways-3",
				h3("Indigenous Cultural Traditions and Lifeways"),
				sliderInput(inputId = "IndigenousLifeways3", label = indigenousLifewaysLabel, value=0, min=0, max=1, step = 0.025)
			),
			#IndustrialHistory
			div(id="industrial-3",
				h3("Industrial Historical Importance"),
				sliderInput(inputId = "IndustrialHistory3", label = industrialHistoryLabel, value=0, min=0, max=1, step = 0.025)
			),
			#CommunityIdentity
			div(id="community-3",
				h3("Community Identity"),
				sliderInput(inputId = "CommunityIdentity3", label = communityIdentityLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Aesthetics
			div(id="aesthetics-3",
				h3("Aesthetic Value"),
				sliderInput(inputId = "Aesthetics3", label = aestheticsLabel, value=0, min=0, max=1, step = 0.025)
			),
			#PublicHealth
			div(id="health-3",
			    h3("Public Health"),
			    sliderInput(inputId = "Health3", label = healthLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Justice
			div(id="justice-3",
			    h3("Socio-Environmental Justice"),
			    sliderInput(inputId = "Justice3", label = justiceLabel, value=0, min=0, max=1, step = 0.025)
			),
			
			actionButton("updateBtn3", "Update")

		), # end
		#End Millinocket Dam 


		tabPanel(
			#"East Millinocket Dam",
			htmlOutput("Dam4"), # status and title
			h2("East Millinocket Dam"),
			HTML(
				"Please consider the decision criteria listed below for East Millinocket Dam.<a>https://github.com/dams-mcda/Dams-MCDA/blob/TabsUpdate_Dams/src/dams_mcda/Factsheet_WestEnfield.pdf</a>\
        <br><b>Warning: decision criteria ratings must sum to 1!</b> The tracking indicator (in the box to the right of the first decision criterion) will help you keep track of the sum. Be aware that decision criteria are directly compensating (i.e., if the sum of all ratings is 1, then\ 
        increasing the rating on one criterion requires another criterion rating to decrease to keep the sum equal to 1). <br>\
				<br>Please consider and rate the given set of criteria based on the case of improved hydropower generation AND fish passage at the dam. <b>In each case, 0 = not at all important and 1 = extremely important.</b><br>"
			),

			htmlOutput("Dam4Progress"),

			#----------------------------------------
			# Criteria Inputs for East Millinocket Dam
			#----------------------------------------
			#Fish Survival
			div(id="fish-survival-4",
				h3("Fish Survival"),
				sliderInput(inputId = "FishBiomass4", label = fishSurvivalLabel, value=0, min=0, max=1, step = 0.025)
			),
			#River Recreation
			div(id="river-rec-4",
				h3("River Recreation"),
				sliderInput(inputId = "RiverRec4", label = riverRecLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Reservoir Storage
			div(id="res-storage-4",
				h3("Reservoir Storage"),
				sliderInput(inputId = "Reservoir4", label = resStorageLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Annuitized Project Costs
			div(id="ann-proj-costs-4",
				h3("Annuitized Project Costs"),
				sliderInput(inputId = "ProjectCost4", label = annuitizedProjCostsLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Breach Damage Potential
			div(id="breach-damage-4",
				h3("Breach Damage Potential"),
				sliderInput(inputId = "Safety4", label = breachDamageLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Number of Properties
			div(id="num-prop-4",
				h3("Number of Properties"),
				sliderInput(inputId = "NumProperties4", label = numPropertiesLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Annual Electricity Generation
			div(id="ann-elec-gen-4",
				h3("Annual Electricity Generation"),
				sliderInput(inputId = "ElectricityGeneration4", label = annualElectricityLabel, value=0, min=0, max=1, step = 0.025)
			),
			#GHGEmissions
			div(id="ghg-emissions-4",
				h3("CO2 Emissions Reductions"),
				sliderInput(inputId = "AvoidEmissions4", label = GHGEmissionsLabel, value=0, min=0, max=1, step = 0.025)
			),
			#IndigenousLifeways
			div(id="indig-lifeways-4",
				h3("Indigenous Cultural Traditions and Lifeways"),
				sliderInput(inputId = "IndigenousLifeways4", label = indigenousLifewaysLabel, value=0, min=0, max=1, step = 0.025)
			),
			#IndustrialHistory
			div(id="industrial-4",
				h3("Industrial Historical Importance"),
				sliderInput(inputId = "IndustrialHistory4", label = industrialHistoryLabel, value=0, min=0, max=1, step = 0.025)
			),
			#CommunityIdentity
			div(id="community-4",
				h3("Community Identity"),
				sliderInput(inputId = "CommunityIdentity4", label = communityIdentityLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Aesthetics
			div(id="aesthetics-4",
				h3("Aesthetic Value"),
				sliderInput(inputId = "Aesthetics4", label = aestheticsLabel, value=0, min=0, max=1, step = 0.025)
			),
			#PublicHealth
			div(id="health-4",
			    h3("Public Health"),
			    sliderInput(inputId = "Health4", label = healthLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Justice
			div(id="justice-4",
			    h3("Socio-Environmental Justice"),
			    sliderInput(inputId = "Justice4", label = justiceLabel, value=0, min=0, max=1, step = 0.025)
			),

			actionButton("updateBtn4", "Update")

		), # end
		#End East Millinocket Dam Tab

		tabPanel(
			#"North Twin",
			htmlOutput("Dam5"), # status and title
			h2("North Twin Dam"),

			HTML(
				"Please consider the decision criteria listed below for North Twin Dam. <a>https://github.com/dams-mcda/Dams-MCDA/blob/TabsUpdate_Dams/src/dams_mcda/Factsheet_PenobscotMills.pdf</a> \
        <br><b>Warning: decision criteria ratings must sum to 1!</b> The tracking indicator (in the box to the right of the first decision criterion) will help you keep track of the sum. Be aware that decision criteria are directly compensating (i.e., if the sum of all ratings is 1, then\ 
        increasing the rating on one criterion requires another criterion rating to decrease to keep the sum equal to 1). <br>\
				<br> Please consider and rate the given set of criteria based on the case of keeping and maintaining the dam. <b>In each case, 0 = not at all important and 1 = extremely important.</b><br>"
			),

			htmlOutput("Dam5Progress"),

			#----------------------------------------
			# Criteria Inputs for North Twin Dam
			#----------------------------------------
			#Fish Survival
			div(id="fish-survival-5",
				h3("Fish Survival"),
				sliderInput(inputId = "FishBiomass5", label = fishSurvivalLabel, value=0, min=0, max=1, step = 0.025)
			),
			#River Recreation
			div(id="river-rec-5",
				h3("River Recreation"),
				sliderInput(inputId = "RiverRec5", label = riverRecLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Reservoir Storage
			div(id="res-storage-5",
				h3("Reservoir Storage"),
				sliderInput(inputId = "Reservoir5", label = resStorageLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Annuitized Project Costs
			div(id="ann-proj-costs-5",
				h3("Annuitized Project Costs"),
				sliderInput(inputId = "ProjectCost5", label = annuitizedProjCostsLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Breach Damage Potential
			div(id="breach-damage-5",
				h3("Breach Damage Potential"),
				sliderInput(inputId = "Safety5", label = breachDamageLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Number of Properties
			div(id="num-prop-5",
				h3("Number of Properties"),
				sliderInput(inputId = "NumProperties5", label = numPropertiesLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Annual Electricity Generation
			div(id="ann-elec-gen-5",
				h3("Annual Electricity Generation"),
				sliderInput(inputId = "ElectricityGeneration5", label = annualElectricityLabel, value=0, min=0, max=1, step = 0.025)
			),
			#GHGEmissions
			div(id="ghg-emissions-5",
				h3("CO2 Emissions Reductions"),
				sliderInput(inputId = "AvoidEmissions5", label = GHGEmissionsLabel, value=0, min=0, max=1, step = 0.025)
			),
			#IndigenousLifeways
			div(id="indig-lifeways-5",
				h3("Indigenous Cultural Traditions and Lifeways"),
				sliderInput(inputId = "IndigenousLifeways5", label = indigenousLifewaysLabel, value=0, min=0, max=1, step = 0.025)
			),
			#IndustrialHistory
			div(id="industrial-5",
				h3("Industrial Historical Importance"),
				sliderInput(inputId = "IndustrialHistory5", label = industrialHistoryLabel, value=0, min=0, max=1, step = 0.025)
			),
			#CommunityIdentity
			div(id="community-5",
				h3("Community Identity"),
				sliderInput(inputId = "CommunityIdentity5", label = communityIdentityLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Aesthetics
			div(id="aesthetics-5",
				h3("Aesthetic Value"),
				sliderInput(inputId = "Aesthetics5", label = aestheticsLabel, value=0, min=0, max=1, step = 0.025)
			),
			#PublicHealth
			div(id="health-5",
			    h3("Public Health"),
			    sliderInput(inputId = "Health5", label = healthLabel, value=0, min=0, max=1, step = 0.025)
			),
			#Justice
			div(id="justice-5",
			    h3("Socio-Environmental Justice"),
			    sliderInput(inputId = "Justice5", label = justiceLabel, value=0, min=0, max=1, step = 0.025)
			),

			actionButton("updateBtn5", "Update")

		), # end
		#End North Twin Dam Tab

		tabPanel(
		  #"Dolby Dam",
		  htmlOutput("Dam6"), # status and title
		  h2("Dolby Dam"),
		  
		  HTML(
		    "Please consider the decision criteria listed below for Dolby Dam. <a>https://github.com/dams-mcda/Dams-MCDA/blob/TabsUpdate_Dams/src/dams_mcda/Factsheet_PenobscotMills.pdf</a> \
		    <br><b>Warning: decision criteria ratings must sum to 1!</b> The tracking indicator (in the box to the right of the first decision criterion) will help you keep track of the sum. Be aware that decision criteria are directly compensating (i.e., if the sum of all ratings is 1, then\ 
		    increasing the rating on one criterion requires another criterion rating to decrease to keep the sum equal to 1). <br>\
		    <br> Please consider and rate the given set of criteria based on the case of keeping and maintaining the dam. <b>In each case, 0 = not at all important and 1 = extremely important.</b><br>"
		  ),
		  
		  htmlOutput("Dam6Progress"),
		  
		  #----------------------------------------
		  # Criteria Inputs for Dolby Dam
		  #----------------------------------------
		  #Fish Survival
		  div(id="fish-survival-6",
		      h3("Fish Survival"),
		      sliderInput(inputId = "FishBiomass6", label = fishSurvivalLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #River Recreation
		  div(id="river-rec-6",
		      h3("River Recreation"),
		      sliderInput(inputId = "RiverRec6", label = riverRecLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Reservoir Storage
		  div(id="res-storage-6",
		      h3("Reservoir Storage"),
		      sliderInput(inputId = "Reservoir6", label = resStorageLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Annuitized Project Costs
		  div(id="ann-proj-costs-6",
		      h3("Annuitized Project Costs"),
		      sliderInput(inputId = "ProjectCost6", label = annuitizedProjCostsLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Breach Damage Potential
		  div(id="breach-damage-6",
		      h3("Breach Damage Potential"),
		      sliderInput(inputId = "Safety6", label = breachDamageLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Number of Properties
		  div(id="num-prop-6",
		      h3("Number of Properties"),
		      sliderInput(inputId = "NumProperties6", label = numPropertiesLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Annual Electricity Generation
		  div(id="ann-elec-gen-6",
		      h3("Annual Electricity Generation"),
		      sliderInput(inputId = "ElectricityGeneration6", label = annualElectricityLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #GHGEmissions
		  div(id="ghg-emissions-6",
		      h3("CO2 Emissions Reductions"),
		      sliderInput(inputId = "AvoidEmissions6", label = GHGEmissionsLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #IndigenousLifeways
		  div(id="indig-lifeways-6",
		      h3("Indigenous Cultural Traditions and Lifeways"),
		      sliderInput(inputId = "IndigenousLifeways6", label = indigenousLifewaysLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #IndustrialHistory
		  div(id="industrial-6",
		      h3("Industrial Historical Importance"),
		      sliderInput(inputId = "IndustrialHistory6", label = industrialHistoryLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #CommunityIdentity
		  div(id="community-6",
		      h3("Community Identity"),
		      sliderInput(inputId = "CommunityIdentity6", label = communityIdentityLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Aesthetics
		  div(id="aesthetics-6",
		      h3("Aesthetic Value"),
		      sliderInput(inputId = "Aesthetics6", label = aestheticsLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #PublicHealth
		  div(id="health-6",
		      h3("Public Health"),
		      sliderInput(inputId = "Health6", label = healthLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Justice
		  div(id="justice-6",
		      h3("Socio-Environmental Justice"),
		      sliderInput(inputId = "Justice6", label = justiceLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  
		  actionButton("updateBtn6", "Update")

		), # end
		#End Dolby Dam Tab
		
		tabPanel(
		  #"Millinocket Lake Dam",
		  htmlOutput("Dam7"), # status and title
		  h2("Millinocket Lake Dam"),
		  
		  HTML(
		    "Please consider the decision criteria listed below for Millinocket Lake Dam. <a>https://github.com/dams-mcda/Dams-MCDA/blob/TabsUpdate_Dams/src/dams_mcda/Factsheet_PenobscotMills.pdf</a>\
		    <br><b>Warning: decision criteria ratings must sum to 1!</b> The tracking indicator (in the box to the right of the first decision criterion) will help you keep track of the sum. Be aware that decision criteria are directly compensating (i.e., if the sum of all ratings is 1, then\ 
		    increasing the rating on one criterion requires another criterion rating to decrease to keep the sum equal to 1). <br>\
		    <br> Please consider and rate the given set of criteria based on the case of keeping and maintaining the dam. <b>In each case, 0 = not at all important and 1 = extremely important.</b><br>"
		  ),
		  
		  htmlOutput("Dam7Progress"),
		  
		  #----------------------------------------
		  # Criteria Inputs for Millinocket Lake Dam
		  #----------------------------------------
		  #Fish Survival
		  div(id="fish-survival-7",
		      h3("Fish Survival"),
		      sliderInput(inputId = "FishBiomass7", label = fishSurvivalLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #River Recreation
		  div(id="river-rec-7",
		      h3("River Recreation"),
		      sliderInput(inputId = "RiverRec7", label = riverRecLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Reservoir Storage
		  div(id="res-storage-7",
		      h3("Reservoir Storage"),
		      sliderInput(inputId = "Reservoir7", label = resStorageLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Annuitized Project Costs
		  div(id="ann-proj-costs-7",
		      h3("Annuitized Project Costs"),
		      sliderInput(inputId = "ProjectCost7", label = annuitizedProjCostsLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Breach Damage Potential
		  div(id="breach-damage-7",
		      h3("Breach Damage Potential"),
		      sliderInput(inputId = "Safety7", label = breachDamageLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Number of Properties
		  div(id="num-prop-7",
		      h3("Number of Properties"),
		      sliderInput(inputId = "NumProperties7", label = numPropertiesLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Annual Electricity Generation
		  div(id="ann-elec-gen-7",
		      h3("Annual Electricity Generation"),
		      sliderInput(inputId = "ElectricityGeneration7", label = annualElectricityLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #GHGEmissions
		  div(id="ghg-emissions-7",
		      h3("CO2 Emissions Reductions"),
		      sliderInput(inputId = "AvoidEmissions7", label = GHGEmissionsLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #IndigenousLifeways
		  div(id="indig-lifeways-7",
		      h3("Indigenous Cultural Traditions and Lifeways"),
		      sliderInput(inputId = "IndigenousLifeways7", label = indigenousLifewaysLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #IndustrialHistory
		  div(id="industrial-7",
		      h3("Industrial Historical Importance"),
		      sliderInput(inputId = "IndustrialHistory7", label = industrialHistoryLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #CommunityIdentity
		  div(id="community-7",
		      h3("Community Identity"),
		      sliderInput(inputId = "CommunityIdentity7", label = communityIdentityLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Aesthetics
		  div(id="aesthetics-7",
		      h3("Aesthetic Value"),
		      sliderInput(inputId = "Aesthetics7", label = aestheticsLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #PublicHealth
		  div(id="health-7",
		      h3("Public Health"),
		      sliderInput(inputId = "Health7", label = healthLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Justice
		  div(id="justice-7",
		      h3("Socio-Environmental Justice"),
		      sliderInput(inputId = "Justice7", label = justiceLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  
		  actionButton("updateBtn7", "Update")

		), # end
		#End Millinocket Lake Dam Tab
		
		tabPanel(
		  #"Ripogenus Dam",
		  htmlOutput("Dam8"), # status and title
		  h2("Ripogenus Dam"),
		  
		  HTML(
		    "Please consider the decision criteria listed below for Ripogenus Dam. <a>https://github.com/dams-mcda/Dams-MCDA/blob/TabsUpdate_Dams/src/dams_mcda/Factsheet_RIpogenus.pdf</a>\
		    <br><b>Warning: decision criteria ratings must sum to 1!</b> The tracking indicator (in the box to the right of the first decision criterion) will help you keep track of the sum. Be aware that decision criteria are directly compensating (i.e., if the sum of all ratings is 1, then\ 
		    increasing the rating on one criterion requires another criterion rating to decrease to keep the sum equal to 1). <br>\
		    <br> Please consider and rate the given set of criteria based on the case of keeping and maintaining the dam. <b>In each case, 0 = not at all important and 1 = extremely important.</b><br>"
		  ),
		  
		  htmlOutput("Dam8Progress"),
		  
		  #----------------------------------------
		  # Criteria Inputs for Ripogenus Dam
		  #----------------------------------------
		  #Fish Survival
		  div(id="fish-survival-8",
		      h3("Fish Survival"),
		      sliderInput(inputId = "FishBiomass8", label = fishSurvivalLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #River Recreation
		  div(id="river-rec-8",
		      h3("River Recreation"),
		      sliderInput(inputId = "RiverRec8", label = riverRecLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Reservoir Storage
		  div(id="res-storage-8",
		      h3("Reservoir Storage"),
		      sliderInput(inputId = "Reservoir8", label = resStorageLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Annuitized Project Costs
		  div(id="ann-proj-costs-8",
		      h3("Annuitized Project Costs"),
		      sliderInput(inputId = "ProjectCost8", label = annuitizedProjCostsLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Breach Damage Potential
		  div(id="breach-damage-8",
		      h3("Breach Damage Potential"),
		      sliderInput(inputId = "Safety8", label = breachDamageLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Number of Properties
		  div(id="num-prop-8",
		      h3("Number of Properties"),
		      sliderInput(inputId = "NumProperties8", label = numPropertiesLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Annual Electricity Generation
		  div(id="ann-elec-gen-8",
		      h3("Annual Electricity Generation"),
		      sliderInput(inputId = "ElectricityGeneration8", label = annualElectricityLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #GHGEmissions
		  div(id="ghg-emissions-8",
		      h3("CO2 Emissions Reductions"),
		      sliderInput(inputId = "AvoidEmissions8", label = GHGEmissionsLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #IndigenousLifeways
		  div(id="indig-lifeways-8",
		      h3("Indigenous Cultural Traditions and Lifeways"),
		      sliderInput(inputId = "IndigenousLifeways8", label = indigenousLifewaysLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #IndustrialHistory
		  div(id="industrial-8",
		      h3("Industrial Historical Importance"),
		      sliderInput(inputId = "IndustrialHistory8", label = industrialHistoryLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #CommunityIdentity
		  div(id="community-8",
		      h3("Community Identity"),
		      sliderInput(inputId = "CommunityIdentity8", label = communityIdentityLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Aesthetics
		  div(id="aesthetics-8",
		      h3("Aesthetic Value"),
		      sliderInput(inputId = "Aesthetics8", label = aestheticsLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #PublicHealth
		  div(id="health-8",
		      h3("Public Health"),
		      sliderInput(inputId = "Health8", label = healthLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  #Justice
		  div(id="justice-8",
		      h3("Socio-Environmental Justice"),
		      sliderInput(inputId = "Justice8", label = justiceLabel, value=0, min=0, max=1, step = 0.025)
		  ),
		  
		  actionButton("updateBtn8", "Update")
		  
		), # end
		#End Ripogenus Dam Tab
		
		"Step 4: View Results",
		tabPanel("Dam 1: West Enfield",
			h2("Results: West Enfield Dam"),
			div(id="dam-1-output",
			    h2("Raw Preference Scores for West Enfield"),
			    plotOutput("SummPlot1", height=graph_height, width=graph_width)
			),
			
			HTML("<br>Click GENERATE to get MCDA results graphs.<br><br>"),
			# generate event
			
			actionButton("generateMatrix1", "Generate"),

			# output post generate
			div(id="generated-output",
				#tableOutput("FilledCriteriaTable"), # for debugging criteria table
				# output post generate
				
				HTML(
				  "<br><b>Figure 1 Interpretation</b>: Recall that the decision criteria ratings under every dam tab were required to sum to 1. Here, the colored decision criteria segments within each decision alternative bar show the contribution of each decision criterion toward each decision\
					alternative score. The largest segments show which preferences most drove your decision making under each decision alternative. You may notice that you consider different decision criteria from one decision alternative to the next. What does this tell you about how you make decisions? It is \
					up to you as a decision maker to decide what to do with this information. <br>"
				),

				h3('Figure 1. Decision Alternative Scores by Decision Criteria'),
				#tableOutput("WSMTable1"), # for debugging plot1
				plotOutput("WSMPlot1", height=600, width="100%"),

				HTML(
				  "<br><b>Figure 2 Interpretation</b>: The decision criterion with the largest bar shows where your greatest overall preference lies. Sometimes, preferences for decision criteria change from one decision alternative to another. You may see variation between\
				  the ratings you chose between decision alternatives. What does this tell you about how you make decisions? It is up to you as a decision maker to decide what to do with this information.<br>\
				  <br>"
        ),

				h3('Figure 2. Total Decision Criteria Scores by Decision Alternative'),
				#tableOutput("WSMTable2"), # for debugging plot2
				plotOutput("WSMPlot2", height=1000, width="100%"),
				# plotly exampl for plot 2
				#plotlyOutput("WSMPlotly2", height=600, width="100%"),
				
				HTML(
          "<br><b>Questions for consideration:</b> Do these results match your expectations? If not, why? If you feel discomfort at the result, you can return to the decision alternative tabs and re-evaluate your criteria ratings. Remember to press \"Update\" under each Alternative tab. Then, return to the Output page and click GENERATE\
					once more to see how your results change (note: you may want to download your results from this session, first).<br>\

					<br> Do these results make sense, given the tradeoffs you made in balancing the set of decision criteria under each decision alternative? Recall that the decision criteria are fully compensating, meaning that as the preference value for one increases, the value for another \
					must necessarily decrease. The idea here is to emphasize tradeoffs between decision criteria.<br> \

					<br><b>Next Steps</b>: If you are participating in the Dam Decision-Making Workshop, the numerical preference values you entered in this Dam Decision Support Tool will be used to generate an optimized multi-dam decision scenario. This scenario, or collection of dams with different decision \
					 alternative results, is created using a Weighted Sum Multi-Criteria Decision Analysis (MCDA) with Multi-Objective Genetic Algortihm (MOGA). Your preference values, entered here, help the MCDA-MOGA to identify the 'optimal' outcome. Please download your results at this time."
				),

				h3('Download Results'),
				downloadButton("downloadData", "Download")
			)
		),
		tabPanel("Dam 2: Medway Dam",
		         h2("Results: Medway Dam"),
		         div(id="dam-2-output",
		             h2("Raw Preference Scores for Medway"),
		             plotOutput("SummPlot2", height=graph_height, width=graph_width)
		         ),
		         
		         HTML("<br>Click GENERATE to get MCDA results graphs.<br><br>"),
		         
		         # generate event
		         actionButton("generateMatrix2", "Generate"),
		         
		         # output post generate
		         div(id="generated-output",
		             #tableOutput("FilledCriteriaTable"), # for debugging criteria table
		             
		             HTML(
		               "<br><b>Figure 1 Interpretation</b>: Recall that the decision criteria ratings under every dam tab were required to sum to 1. Here, the colored decision criteria segments within each decision alternative bar show the contribution of each decision criterion toward each decision\
		               alternative score. The largest segments show which preferences most drove your decision making under each decision alternative. You may notice that you consider different decision criteria from one decision alternative to the next. What does this tell you about how you make decisions? It is \
		               up to you as a decision maker to decide what to do with this information. <br>"
		             ),
		             
		             h3('Figure 1. Decision Alternative Scores by Decision Criteria'),
		             #tableOutput("WSMTable1"), # for debugging plot1
		             plotOutput("WSMPlot1", height=600, width="100%"),
		             
		             HTML(
		               "<br><b>Figure 2 Interpretation</b>: The decision criterion with the largest bar shows where your greatest overall preference lies. Sometimes, preferences for decision criteria change from one decision alternative to another. You may see variation between\
		               the ratings you chose between decision alternatives. What does this tell you about how you make decisions? It is up to you as a decision maker to decide what to do with this information.<br>\
		               <br>"
		             ),
		             
		             h3('Figure 2. Total Decision Criteria Scores by Decision Alternative'),
		             #tableOutput("WSMTable2"), # for debugging plot2
		             plotOutput("WSMPlot2", height=1000, width="100%"),
		             # plotly exampl for plot 2
		             #plotlyOutput("WSMPlotly2", height=600, width="100%"),
		             
		             HTML(
		               "<br><b>Questions for consideration:</b> Do these results match your expectations? If not, why? If you feel discomfort at the result, you can return to the decision alternative tabs and re-evaluate your criteria ratings. Remember to press \"Update\" under each Alternative tab. Then, return to the Output page and click GENERATE\
		               once more to see how your results change (note: you may want to download your results from this session, first).<br>\
		               
		               <br> Do these results make sense, given the tradeoffs you made in balancing the set of decision criteria under each decision alternative? Recall that the decision criteria are fully compensating, meaning that as the preference value for one increases, the value for another \
		               must necessarily decrease. The idea here is to emphasize tradeoffs between decision criteria.<br> \
		               
		               <br><b>Next Steps</b>: If you are participating in the Dam Decision-Making Workshop, the numerical preference values you entered in this Dam Decision Support Tool will be used to generate an optimized multi-dam decision scenario. This scenario, or collection of dams with different decision \
		               alternative results, is created using a Weighted Sum Multi-Criteria Decision Analysis (MCDA) with Multi-Objective Genetic Algortihm (MOGA). Your preference values, entered here, help the MCDA-MOGA to identify the 'optimal' outcome. Please download your results at this time."
		             ),
		             
		             h3('Download Results'),
		             downloadButton("downloadData", "Download")
		             )
		             ),
		tabPanel("Dam 3: Millinocket Dam",
		         h2("Results: Millinocket Dam"),
		         div(id="dam-3-output",
		             h2("Raw Preference Scores for Millinocket"),
		             plotOutput("SummPlot3", height=graph_height, width=graph_width)
		         ),
		         
		         HTML("<br>Click GENERATE to get MCDA results graphs.<br><br>"),
		         
		         
		         # generate event
		         actionButton("generateMatrix3", "Generate"),
		         
		         # output post generate
		         div(id="generated-output",
		             #tableOutput("FilledCriteriaTable"), # for debugging criteria table
		             
		             HTML(
		               "<br><b>Figure 1 Interpretation</b>: Recall that the decision criteria ratings under every dam tab were required to sum to 1. Here, the colored decision criteria segments within each decision alternative bar show the contribution of each decision criterion toward each decision\
		               alternative score. The largest segments show which preferences most drove your decision making under each decision alternative. You may notice that you consider different decision criteria from one decision alternative to the next. What does this tell you about how you make decisions? It is \
		               up to you as a decision maker to decide what to do with this information. <br>"
		             ),
		             
		             h3('Figure 1. Decision Alternative Scores by Decision Criteria'),
		             #tableOutput("WSMTable1"), # for debugging plot1
		             plotOutput("WSMPlot1", height=600, width="100%"),
		             
		             HTML(
		               "<br><b>Figure 2 Interpretation</b>: The decision criterion with the largest bar shows where your greatest overall preference lies. Sometimes, preferences for decision criteria change from one decision alternative to another. You may see variation between\
		               the ratings you chose between decision alternatives. What does this tell you about how you make decisions? It is up to you as a decision maker to decide what to do with this information.<br>\
		               <br>"
		             ),
		             
		             h3('Figure 2. Total Decision Criteria Scores by Decision Alternative'),
		             #tableOutput("WSMTable2"), # for debugging plot2
		             plotOutput("WSMPlot2", height=1000, width="100%"),
		             # plotly exampl for plot 2
		             #plotlyOutput("WSMPlotly2", height=600, width="100%"),
		             
		             HTML(
		               "<br><b>Questions for consideration:</b> Do these results match your expectations? If not, why? If you feel discomfort at the result, you can return to the decision alternative tabs and re-evaluate your criteria ratings. Remember to press \"Update\" under each Alternative tab. Then, return to the Output page and click GENERATE\
		               once more to see how your results change (note: you may want to download your results from this session, first).<br>\
		               
		               <br> Do these results make sense, given the tradeoffs you made in balancing the set of decision criteria under each decision alternative? Recall that the decision criteria are fully compensating, meaning that as the preference value for one increases, the value for another \
		               must necessarily decrease. The idea here is to emphasize tradeoffs between decision criteria.<br> \
		               
		               <br><b>Next Steps</b>: If you are participating in the Dam Decision-Making Workshop, the numerical preference values you entered in this Dam Decision Support Tool will be used to generate an optimized multi-dam decision scenario. This scenario, or collection of dams with different decision \
		               alternative results, is created using a Weighted Sum Multi-Criteria Decision Analysis (MCDA) with Multi-Objective Genetic Algortihm (MOGA). Your preference values, entered here, help the MCDA-MOGA to identify the 'optimal' outcome. Please download your results at this time."
		             ),
		             
		             h3('Download Results'),
		             downloadButton("downloadData", "Download")
		             )
		             ),
		tabPanel("Dam 4: East Millinocket Dam",
		         h2("Results: East Millinocket Dam"),
		         div(id="dam-4-output",
		             h2("Raw Preference Scores for East Millinocket"),
		             plotOutput("SummPlot4", height=graph_height, width=graph_width)
		         ),
		         
		         HTML("<br>Click GENERATE to get MCDA results graphs.<br><br>"),
		         
		         # generate event
		         actionButton("generateMatrix4", "Generate"),
		         
		         # output post generate
		         div(id="generated-output",
		             #tableOutput("FilledCriteriaTable"), # for debugging criteria table
		             
		             HTML(
		               "<br><b>Figure 1 Interpretation</b>: Recall that the decision criteria ratings under every dam tab were required to sum to 1. Here, the colored decision criteria segments within each decision alternative bar show the contribution of each decision criterion toward each decision\
		               alternative score. The largest segments show which preferences most drove your decision making under each decision alternative. You may notice that you consider different decision criteria from one decision alternative to the next. What does this tell you about how you make decisions? It is \
		               up to you as a decision maker to decide what to do with this information. <br>"
		             ),
		             
		             h3('Figure 1. Decision Alternative Scores by Decision Criteria'),
		             #tableOutput("WSMTable1"), # for debugging plot1
		             plotOutput("WSMPlot1", height=600, width="100%"),
		             
		             HTML(
		               "<br><b>Figure 2 Interpretation</b>: The decision criterion with the largest bar shows where your greatest overall preference lies. Sometimes, preferences for decision criteria change from one decision alternative to another. You may see variation between\
		               the ratings you chose between decision alternatives. What does this tell you about how you make decisions? It is up to you as a decision maker to decide what to do with this information.<br>\
		               <br>"
		             ),
		             
		             h3('Figure 2. Total Decision Criteria Scores by Decision Alternative'),
		             #tableOutput("WSMTable2"), # for debugging plot2
		             plotOutput("WSMPlot2", height=1000, width="100%"),
		             # plotly exampl for plot 2
		             #plotlyOutput("WSMPlotly2", height=600, width="100%"),
		             
		             HTML(
		               "<br><b>Questions for consideration:</b> Do these results match your expectations? If not, why? If you feel discomfort at the result, you can return to the decision alternative tabs and re-evaluate your criteria ratings. Remember to press \"Update\" under each Alternative tab. Then, return to the Output page and click GENERATE\
		               once more to see how your results change (note: you may want to download your results from this session, first).<br>\
		               
		               <br> Do these results make sense, given the tradeoffs you made in balancing the set of decision criteria under each decision alternative? Recall that the decision criteria are fully compensating, meaning that as the preference value for one increases, the value for another \
		               must necessarily decrease. The idea here is to emphasize tradeoffs between decision criteria.<br> \
		               
		               <br><b>Next Steps</b>: If you are participating in the Dam Decision-Making Workshop, the numerical preference values you entered in this Dam Decision Support Tool will be used to generate an optimized multi-dam decision scenario. This scenario, or collection of dams with different decision \
		               alternative results, is created using a Weighted Sum Multi-Criteria Decision Analysis (MCDA) with Multi-Objective Genetic Algortihm (MOGA). Your preference values, entered here, help the MCDA-MOGA to identify the 'optimal' outcome. Please download your results at this time."
		             ),
		             
		             h3('Download Results'),
		             downloadButton("downloadData", "Download")
		             )
		             ),
		tabPanel("Dam 5: North Twin",
		         h2("Results: North Twin Dam"),
		         div(id="dam-5-output",
		             h2("Raw Preference Scores for North Twin"),
		             plotOutput("SummPlot5", height=graph_height, width=graph_width)
		         ),
		         
		         HTML("<br>Click GENERATE to get MCDA results graphs.<br><br>"),
		         
		         # generate event
		         actionButton("generateMatrix5", "Generate"),
		         
		         # output post generate
		         div(id="generated-output",
		             #tableOutput("FilledCriteriaTable"), # for debugging criteria table
		             
		             HTML(
		               "<br><b>Figure 1 Interpretation</b>: Recall that the decision criteria ratings under every dam tab were required to sum to 1. Here, the colored decision criteria segments within each decision alternative bar show the contribution of each decision criterion toward each decision\
		               alternative score. The largest segments show which preferences most drove your decision making under each decision alternative. You may notice that you consider different decision criteria from one decision alternative to the next. What does this tell you about how you make decisions? It is \
		               up to you as a decision maker to decide what to do with this information. <br>"
		             ),
		             
		             h3('Figure 1. Decision Alternative Scores by Decision Criteria'),
		             #tableOutput("WSMTable1"), # for debugging plot1
		             plotOutput("WSMPlot1", height=600, width="100%"),
		             
		             HTML(
		               "<br><b>Figure 2 Interpretation</b>: The decision criterion with the largest bar shows where your greatest overall preference lies. Sometimes, preferences for decision criteria change from one decision alternative to another. You may see variation between\
				  the ratings you chose between decision alternatives. What does this tell you about how you make decisions? It is up to you as a decision maker to decide what to do with this information.<br>\
				  <br>"
		             ),
		             
		             h3('Figure 2. Total Decision Criteria Scores by Decision Alternative'),
		             #tableOutput("WSMTable2"), # for debugging plot2
		             plotOutput("WSMPlot2", height=1000, width="100%"),
		             # plotly exampl for plot 2
		             #plotlyOutput("WSMPlotly2", height=600, width="100%"),
		             
		             HTML(
		               "<br><b>Questions for consideration:</b> Do these results match your expectations? If not, why? If you feel discomfort at the result, you can return to the decision alternative tabs and re-evaluate your criteria ratings. Remember to press \"Update\" under each Alternative tab. Then, return to the Output page and click GENERATE\
					once more to see how your results change (note: you may want to download your results from this session, first).<br>\

					<br> Do these results make sense, given the tradeoffs you made in balancing the set of decision criteria under each decision alternative? Recall that the decision criteria are fully compensating, meaning that as the preference value for one increases, the value for another \
					must necessarily decrease. The idea here is to emphasize tradeoffs between decision criteria.<br> \

					<br><b>Next Steps</b>: If you are participating in the Dam Decision-Making Workshop, the numerical preference values you entered in this Dam Decision Support Tool will be used to generate an optimized multi-dam decision scenario. This scenario, or collection of dams with different decision \
					 alternative results, is created using a Weighted Sum Multi-Criteria Decision Analysis (MCDA) with Multi-Objective Genetic Algortihm (MOGA). Your preference values, entered here, help the MCDA-MOGA to identify the 'optimal' outcome. Please download your results at this time."
		             ),
		             
		             h3('Download Results'),
		             downloadButton("downloadData", "Download")
		             )
		         ),
		tabPanel("Dam 6: Dolby",
		         h2("Results: Dolby Dam"),
		         div(id="dam-6-output",
		             h2("Raw Preference Scores for Dolby"),
		             plotOutput("SummPlot6", height=graph_height, width=graph_width)
		         ),
		         
		         HTML("<br>Click GENERATE to get MCDA results graphs.<br><br>"),
		         
		         # generate event
		         actionButton("generateMatrix6", "Generate"),
		         
		         # output post generate
		         div(id="generated-output",
		             #tableOutput("FilledCriteriaTable"), # for debugging criteria table
		             
		             HTML(
		               "<br><b>Figure 1 Interpretation</b>: Recall that the decision criteria ratings under every dam tab were required to sum to 1. Here, the colored decision criteria segments within each decision alternative bar show the contribution of each decision criterion toward each decision\
		               alternative score. The largest segments show which preferences most drove your decision making under each decision alternative. You may notice that you consider different decision criteria from one decision alternative to the next. What does this tell you about how you make decisions? It is \
		               up to you as a decision maker to decide what to do with this information. <br>"
		             ),
		             
		             h3('Figure 1. Decision Alternative Scores by Decision Criteria'),
		             #tableOutput("WSMTable1"), # for debugging plot1
		             plotOutput("WSMPlot1", height=600, width="100%"),
		             
		             HTML(
		               "<br><b>Figure 2 Interpretation</b>: The decision criterion with the largest bar shows where your greatest overall preference lies. Sometimes, preferences for decision criteria change from one decision alternative to another. You may see variation between\
		               the ratings you chose between decision alternatives. What does this tell you about how you make decisions? It is up to you as a decision maker to decide what to do with this information.<br>\
		               <br>"
		             ),
		             
		             h3('Figure 2. Total Decision Criteria Scores by Decision Alternative'),
		             #tableOutput("WSMTable2"), # for debugging plot2
		             plotOutput("WSMPlot2", height=1000, width="100%"),
		             # plotly exampl for plot 2
		             #plotlyOutput("WSMPlotly2", height=600, width="100%"),
		             
		             HTML(
		               "<br><b>Questions for consideration:</b> Do these results match your expectations? If not, why? If you feel discomfort at the result, you can return to the decision alternative tabs and re-evaluate your criteria ratings. Remember to press \"Update\" under each Alternative tab. Then, return to the Output page and click GENERATE\
		               once more to see how your results change (note: you may want to download your results from this session, first).<br>\
		               
		               <br> Do these results make sense, given the tradeoffs you made in balancing the set of decision criteria under each decision alternative? Recall that the decision criteria are fully compensating, meaning that as the preference value for one increases, the value for another \
		               must necessarily decrease. The idea here is to emphasize tradeoffs between decision criteria.<br> \
		               
		               <br><b>Next Steps</b>: If you are participating in the Dam Decision-Making Workshop, the numerical preference values you entered in this Dam Decision Support Tool will be used to generate an optimized multi-dam decision scenario. This scenario, or collection of dams with different decision \
		               alternative results, is created using a Weighted Sum Multi-Criteria Decision Analysis (MCDA) with Multi-Objective Genetic Algortihm (MOGA). Your preference values, entered here, help the MCDA-MOGA to identify the 'optimal' outcome. Please download your results at this time."
		             ),
		             
		             h3('Download Results'),
		             downloadButton("downloadData", "Download")
		             )
		             ),
		tabPanel("Dam 7: Millinocket Lake",
		         h2("Results: Millinocket Lake Dam"),
		         div(id="dam-7-output",
		             h2("Raw Preference Scores for Millinocket Lake"),
		             plotOutput("SummPlot7", height=graph_height, width=graph_width)
		         ),
		         
		         HTML("<br>Click GENERATE to get MCDA results graphs.<br><br>"),
		         
		         # generate event
		         actionButton("generateMatrix7", "Generate"),
		         
		         # output post generate
		         div(id="generated-output",
		             #tableOutput("FilledCriteriaTable"), # for debugging criteria table
		             
		             HTML(
		               "<br><b>Figure 1 Interpretation</b>: Recall that the decision criteria ratings under every dam tab were required to sum to 1. Here, the colored decision criteria segments within each decision alternative bar show the contribution of each decision criterion toward each decision\
		               alternative score. The largest segments show which preferences most drove your decision making under each decision alternative. You may notice that you consider different decision criteria from one decision alternative to the next. What does this tell you about how you make decisions? It is \
		               up to you as a decision maker to decide what to do with this information. <br>"
		             ),
		             
		             h3('Figure 1. Decision Alternative Scores by Decision Criteria'),
		             #tableOutput("WSMTable1"), # for debugging plot1
		             plotOutput("WSMPlot1", height=600, width="100%"),
		             
		             HTML(
		               "<br><b>Figure 2 Interpretation</b>: The decision criterion with the largest bar shows where your greatest overall preference lies. Sometimes, preferences for decision criteria change from one decision alternative to another. You may see variation between\
		               the ratings you chose between decision alternatives. What does this tell you about how you make decisions? It is up to you as a decision maker to decide what to do with this information.<br>\
		               <br>"
		             ),
		             
		             h3('Figure 2. Total Decision Criteria Scores by Decision Alternative'),
		             #tableOutput("WSMTable2"), # for debugging plot2
		             plotOutput("WSMPlot2", height=1000, width="100%"),
		             # plotly exampl for plot 2
		             #plotlyOutput("WSMPlotly2", height=600, width="100%"),
		             
		             HTML(
		               "<br><b>Questions for consideration:</b> Do these results match your expectations? If not, why? If you feel discomfort at the result, you can return to the decision alternative tabs and re-evaluate your criteria ratings. Remember to press \"Update\" under each Alternative tab. Then, return to the Output page and click GENERATE\
		               once more to see how your results change (note: you may want to download your results from this session, first).<br>\
		               
		               <br> Do these results make sense, given the tradeoffs you made in balancing the set of decision criteria under each decision alternative? Recall that the decision criteria are fully compensating, meaning that as the preference value for one increases, the value for another \
		               must necessarily decrease. The idea here is to emphasize tradeoffs between decision criteria.<br> \
		               
		               <br><b>Next Steps</b>: If you are participating in the Dam Decision-Making Workshop, the numerical preference values you entered in this Dam Decision Support Tool will be used to generate an optimized multi-dam decision scenario. This scenario, or collection of dams with different decision \
		               alternative results, is created using a Weighted Sum Multi-Criteria Decision Analysis (MCDA) with Multi-Objective Genetic Algortihm (MOGA). Your preference values, entered here, help the MCDA-MOGA to identify the 'optimal' outcome. Please download your results at this time."
		             ),
		             
		             h3('Download Results'),
		             downloadButton("downloadData", "Download")
		             )
		             ),
		tabPanel("Dam 8: Ripogenus",
		         h2("Results: Ripogenus Dam"),
		         div(id="dam-8-output",
		             h2("Raw Preference Scores for Ripogenus"),
		             plotOutput("SummPlot8", height=graph_height, width=graph_width)
		         ),
		         
		         HTML("<br>Click GENERATE to get MCDA results graphs.<br><br>"),
		         
		         # generate event
		         actionButton("generateMatrix8", "Generate"),
		         
		         # output post generate
		         div(id="generated-output",
		             #tableOutput("FilledCriteriaTable"), # for debugging criteria table
		             
		             HTML(
		               "<br><b>Figure 1 Interpretation</b>: Recall that the decision criteria ratings under every dam tab were required to sum to 1. Here, the colored decision criteria segments within each decision alternative bar show the contribution of each decision criterion toward each decision\
		               alternative score. The largest segments show which preferences most drove your decision making under each decision alternative. You may notice that you consider different decision criteria from one decision alternative to the next. What does this tell you about how you make decisions? It is \
		               up to you as a decision maker to decide what to do with this information. <br>"
		             ),
		             
		             h3('Figure 1. Decision Alternative Scores by Decision Criteria'),
		             #tableOutput("WSMTable1"), # for debugging plot1
		             plotOutput("WSMPlot1", height=600, width="100%"),
		             
		             HTML(
		               "<br><b>Figure 2 Interpretation</b>: The decision criterion with the largest bar shows where your greatest overall preference lies. Sometimes, preferences for decision criteria change from one decision alternative to another. You may see variation between\
		               the ratings you chose between decision alternatives. What does this tell you about how you make decisions? It is up to you as a decision maker to decide what to do with this information.<br>\
		               <br>"
		             ),
		             
		             h3('Figure 2. Total Decision Criteria Scores by Decision Alternative'),
		             #tableOutput("WSMTable2"), # for debugging plot2
		             plotOutput("WSMPlot2", height=1000, width="100%"),
		             # plotly exampl for plot 2
		             #plotlyOutput("WSMPlotly2", height=600, width="100%"),
		             
		             HTML(
		               "<br><b>Questions for consideration:</b> Do these results match your expectations? If not, why? If you feel discomfort at the result, you can return to the decision alternative tabs and re-evaluate your criteria ratings. Remember to press \"Update\" under each Alternative tab. Then, return to the Output page and click GENERATE\
		               once more to see how your results change (note: you may want to download your results from this session, first).<br>\
		               
		               <br> Do these results make sense, given the tradeoffs you made in balancing the set of decision criteria under each decision alternative? Recall that the decision criteria are fully compensating, meaning that as the preference value for one increases, the value for another \
		               must necessarily decrease. The idea here is to emphasize tradeoffs between decision criteria.<br> \
		               
		               <br><b>Next Steps</b>: If you are participating in the Dam Decision-Making Workshop, the numerical preference values you entered in this Dam Decision Support Tool will be used to generate an optimized multi-dam decision scenario. This scenario, or collection of dams with different decision \
		               alternative results, is created using a Weighted Sum Multi-Criteria Decision Analysis (MCDA) with Multi-Objective Genetic Algortihm (MOGA). Your preference values, entered here, help the MCDA-MOGA to identify the 'optimal' outcome. Please download your results at this time."
		             ),
		             
		             h3('Download Results'),
		             downloadButton("downloadData", "Download")
		             )
		             ),
		tabPanel("Developers",
			 h2("Developers"),
			 HTML(
				 "<b>Emma Fox </b>- Lead Developer (Ph.D. candidate, University of Maine Ecology and Environmental Science Program) for the Dam Decision Support Tool. Designed user interface and initial server functionality. Adjusted WSM function for new dam decision application and advised model-related changes. \
				 Designed and wrote app text, and designed accompanying multi-dam decision example fact sheets, designed and wrote text for Dam Toolbox.<br> \
				 <br><b>Dr. Sharon J. W. Klein </b>- Development Advisor (Associate Professor, University of Maine School of Economics). Helped develop and advise concept for the Dam Decision Support Tool, advised user-friendliness enhancements to the Dam Decision Support Tool and user interface/features, refined criteria \
         definitions, revised app text.<br> \
         <br><b>Dr. Samuel G. Roy </b>- Feature Developer (Postdoctoral Researcher, Senator George J. Mitchell Center for Sustainability Solutions, University of Maine) for the Dam Decision Support Tool. Developed Matlab scripts for multi-rank calculation, fitness functions for network-dependent criteria, and preference weighting.\
				 <br><b>William Winslow </b>- Developer (Software Engineer, GeoSpatial Science Center(GSSC), University of New Hampshire). Deployment (Docker, Apache), server code reorganization, debugging/bug fixes, misc. feature implementations for user interface and app function.<br>"
			 )
		),

		tabPanel("Acknowledgements",
			 h2("Acknowledgments"),
			 HTML(
				 "We would like to thank Garrett Raymond for his technical consultation on R Shiny design.<br> \
				 <br> This tool was developed by researchers in the Future of Dams project. Support for the Future of Dams project is provided by the National Science Foundation\'s Research Infrastructure Improvement NSF #IIA-1539071, \
				 USDA National Institute of Food and Agriculture, Hatch project 0230040, and Department of the Interior, \
				 U.S. Geological Survey Grant No. G16AP00057 through the Senator George J. Mitchell Center at the University of Maine.<br>\
				 <br> The Data Discovery Center at the University of New Hampshire is the host for this Dam Decision Support Tool. https://ddc.unh.edu <br>"
			 ),
			 h2("Citations"),
			 HTML(
				 "Roy, S.G., Uchida, E., de Souza, S.P., Blachly, B., Fox, E., Gardner, K., Gold, A.J., Jansujwicz, J., Klein, S., McGreavy, B., Mo, W., Smith, S.M.C., Vogler, E., Wilson, K., Zydlewski, J., & Hart, D. (2018). A multiscale approach to balance trade-offs among dam infrastructure, river restoration, and cost. Proceedings of the National \
				 Academy of Sciences, 201807437. doi:10.1073/pnas.1807437115.<br>\
				 "
			 )

		)
)))

# create the application with ui in this file and imported server from server.R
shinyApp(ui, server)
